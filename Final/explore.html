<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore Ghana's amazing destinations - from historic castles to national parks, beaches to cultural sites. Discover your perfect Ghana adventure.">
    <meta name="author" content="Your Name">
    <meta name="keywords" content="Ghana destinations, Ghana tourism, explore Ghana, Ghana attractions">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Explore Ghana Destinations - Experience Ghana">
    <meta property="og:description" content="Discover Ghana's incredible destinations from coast to mountains.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/wdd231/final/explore.html">
    <meta property="og:image" content="images/ghana-destinations.jpg">
    
    <title>Explore Ghana Destinations - Experience Ghana</title>
    <link rel="icon" type="image/x-icon" href="./images/ghana-flag.png">
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="./css/responsive.css">
    
    
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <img src="./images/ghana-flag.png" alt="Ghana Flag" class="logo-icon">
                <span class="logo-text">Experience Ghana</span>
            </div>
            <nav class="main-nav">
                <button class="hamburger" id="hamburger" aria-label="Menu toggle">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
                <ul class="nav-menu" id="nav-menu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="explore.html" class="nav-link active">Explore</a></li>
                    <li><a href="taste.html" class="nav-link">Taste</a></li>
                    <li><a href="travel-tips.html" class="nav-link">Travel Tips</a></li>
                    <li><a href="attributions.html" class="nav-link">attributions</a></li>
                    
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <!-- Page Header -->
        <section class="explore-header">
            <div class="container">
                <h1 class="explore-title">Explore Ghana's Destinations</h1>
                <p class="explore-subtitle">
                    Discover 17+ incredible destinations across Ghana. From historic castles and pristine beaches 
                    to lush national parks and vibrant cultural sites.
                </p>
            </div>
        </section>

        <!-- Filters Section -->
        <div class="filters-section">
            <div class="container">
                <div class="filters-container">
                    <div class="filter-group">
                        <label for="search-input" class="filter-label">Search Destinations</label>
                        <input type="text" id="search-input" class="filter-input" 
                               placeholder="Search by name, location, or activity...">
                    </div>
                    
                    <div class="filter-group">
                        <label for="category-filter" class="filter-label">Category</label>
                        <select id="category-filter" class="filter-select">
                            <option value="all">All Categories</option>
                            <!-- Options will be dynamically populated -->
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="region-filter" class="filter-label">Region</label>
                        <select id="region-filter" class="filter-select">
                            <option value="all">All Regions</option>
                            <!-- Options will be dynamically populated -->
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="cost-filter" class="filter-label">Cost Level</label>
                        <select id="cost-filter" class="filter-select">
                            <option value="all">All Cost Levels</option>
                            <option value="free">Free</option>
                            <option value="budget">Budget-friendly</option>
                            <option value="moderate">Moderate</option>
                            <option value="expensive">Expensive</option>
                        </select>
                    </div>
                </div>
                
                <div class="filters-actions">
                    <button class="filter-btn apply-filters" id="apply-filters">Apply Filters</button>
                    <button class="filter-btn clear-filters" id="clear-filters">Clear All</button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section">
            <div class="container">
                <div class="results-header">
                    <div class="results-count" id="result-count">Loading destinations...</div>
                    <div class="sort-controls">
                        <label for="sort-select" class="sort-label">Sort by:</label>
                        <select id="sort-select" class="sort-select">
                            <option value="name">Name (A-Z)</option>
                            <option value="rating">Rating (High to Low)</option>
                            <option value="location">Location</option>
                            <option value="category">Category</option>
                            <option value="cost">Cost Level</option>
                        </select>
                    </div>
                </div>
                
                <!-- Destinations will be dynamically loaded here -->
                <div id="destinations-container">
                    <!-- Loading state -->
                    <div class="loading-spinner" id="loading-spinner">
                        <div class="spinner-animation"></div>
                        <p class="spinner-message">Loading amazing Ghana destinations...</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for destination details -->
    <div id="destination-modal" class="modal" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Destination Details</h2>
                <button class="close-modal" id="close-modal" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Content will be dynamically inserted -->
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Experience Ghana</h3>
                    <p>Your gateway to discovering West Africa's cultural heart.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="explore.html">Destinations</a></li>
                        <li><a href="taste.html">Food & Culture</a></li>
                        <li><a href="travel-tips.html">Travel Tips</a></li>
                        <li><a href="attributions.html">Attributions</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#" id="video-link">Project Video</a></li>
                        <li><a href="mailto:contact@experienceghana.com">Contact Us</a></li>
                        <li><a href="#" target="_blank">Ghana Tourism Authority</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Experience Ghana. Educational project for WDD 231.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        // Explore page JavaScript
        // Demonstrates comprehensive use of all JavaScript requirements
        
        import { 
            fetchDestinations, 
            displayDestinations, 
            filterDestinations, 
            sortDestinations,
            searchDestinations,
            getUniqueCategories,
            getUniqueRegions,
            getDestinationStats
        } from './js/modules/destinations.js';
        
        import { 
            showModal, 
            hideModal, 
            toggleMobileMenu,
            showNotification,
            hideLoadingSpinner
        } from './js/modules/ui.js';
        
        import { 
            saveUserPreference, 
            getUserPreference,
            saveSearchTerm,
            saveVisitedDestination
        } from './js/modules/storage.js';

        // Global variables
        let allDestinations = [];
        let filteredDestinations = [];
        let currentFilters = {
            search: '',
            category: 'all',
            region: 'all',
            costLevel: 'all'
        };
        let currentSort = 'name';

        // Initialize page
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await initializeExplorePage();
                setupEventListeners();
                console.log('Explore page initialized successfully');
            } catch (error) {
                console.error('Error initializing explore page:', error);
                showErrorState();
            }
        });

        /**
         * Initialize the explore page
         * Demonstrates async operations with try-catch
         */
        async function initializeExplorePage() {
            try {
                // Fetch destinations data
                allDestinations = await fetchDestinations();
                
                if (allDestinations.length === 0) {
                    throw new Error('No destinations data available');
                }
                
                // Populate filter options
                populateFilterOptions();
                
                // Apply initial filters and display
                applyFiltersAndDisplay();
                
                // Load user preferences
                loadUserPreferences();
                
                // Hide loading spinner
                hideLoadingSpinner('loading-spinner');
                
                // Track page visit
                saveUserPreference('explorePageVisits', 
                    (getUserPreference('explorePageVisits', 0) + 1));
                
                showNotification(`Welcome to Explore Ghana! ${allDestinations.length} destinations loaded.`, 'success', 3000);
                
            } catch (error) {
                console.error('Error in initializeExplorePage:', error);
                hideLoadingSpinner('loading-spinner');
                showErrorState();
            }
        }

        /**
         * Populate filter dropdown options
         * Demonstrates array methods for data extraction
         */
        function populateFilterOptions() {
            // Get unique categories and regions using array methods
            const categories = getUniqueCategories(allDestinations);
            const regions = getUniqueRegions(allDestinations);
            
            // Populate category filter
            const categorySelect = document.getElementById('category-filter');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.toLowerCase();
                option.textContent = category;
                categorySelect.appendChild(option);
            });
            
            // Populate region filter
            const regionSelect = document.getElementById('region-filter');
            regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region.toLowerCase();
                option.textContent = region.charAt(0).toUpperCase() + region.slice(1);
                regionSelect.appendChild(option);
            });
        }

        /**
         * Apply filters and display results
         * Demonstrates array filtering and sorting methods
         */
        function applyFiltersAndDisplay() {
            try {
                // Start with all destinations
                let results = [...allDestinations];
                
                // Apply search filter using array methods
                if (currentFilters.search) {
                    results = searchDestinations(results, currentFilters.search);
                    saveSearchTerm(currentFilters.search);
                }
                
                // Apply category filter
                if (currentFilters.category !== 'all') {
                    results = results.filter(dest => 
                        dest.category.toLowerCase() === currentFilters.category
                    );
                }
                
                // Apply region filter
                if (currentFilters.region !== 'all') {
                    results = results.filter(dest => 
                        dest.region.toLowerCase() === currentFilters.region
                    );
                }
                
                // Apply cost filter
                if (currentFilters.costLevel !== 'all') {
                    results = results.filter(dest => 
                        dest.costLevel.toLowerCase().includes(currentFilters.costLevel)
                    );
                }
                
                // Sort results using array methods
                results = sortDestinations(results, currentSort);
                
                // Store filtered results
                filteredDestinations = results;
                
                // Display results
                displayDestinations(results, 'destinations-container');
                
                // Update results count
                updateResultsCount(results.length);
                
                // Save filter preferences
                saveFilterPreferences();
                
            } catch (error) {
                console.error('Error applying filters:', error);
                showNotification('Error filtering destinations. Please try again.', 'error');
            }
        }

        /**
         * Update results count display
         * Demonstrates template literals
         */
        function updateResultsCount(count) {
            const resultCount = document.getElementById('result-count');
            resultCount.textContent = `${count} destination${count !== 1 ? 's' : ''} found`;
        }

        /**
         * Setup event listeners
         * Demonstrates DOM manipulation and event handling
         */
        function setupEventListeners() {
            // Mobile menu toggle
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('nav-menu');
            
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', () => {
                    toggleMobileMenu(navMenu);
                });
            }
            
            // Search input with debouncing
            const searchInput = document.getElementById('search-input');
            let searchTimeout;
            
            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    currentFilters.search = e.target.value.trim();
                    applyFiltersAndDisplay();
                }, 300); // 300ms debounce
            });
            
            // Filter selects
            const categoryFilter = document.getElementById('category-filter');
            const regionFilter = document.getElementById('region-filter');
            const costFilter = document.getElementById('cost-filter');
            
            categoryFilter.addEventListener('change', (e) => {
                currentFilters.category = e.target.value;
                applyFiltersAndDisplay();
            });
            
            regionFilter.addEventListener('change', (e) => {
                currentFilters.region = e.target.value;
                applyFiltersAndDisplay();
            });
            
            costFilter.addEventListener('change', (e) => {
                currentFilters.costLevel = e.target.value;
                applyFiltersAndDisplay();
            });
            
            // Sort select
            const sortSelect = document.getElementById('sort-select');
            sortSelect.addEventListener('change', (e) => {
                currentSort = e.target.value;
                applyFiltersAndDisplay();
            });
            
            // Filter buttons
            const applyBtn = document.getElementById('apply-filters');
            const clearBtn = document.getElementById('clear-filters');
            
            applyBtn.addEventListener('click', () => {
                applyFiltersAndDisplay();
                showNotification('Filters applied successfully!', 'success', 2000);
            });
            
            clearBtn.addEventListener('click', () => {
                clearAllFilters();
                showNotification('All filters cleared!', 'info', 2000);
            });
            
            // Modal events
            const closeModal = document.getElementById('close-modal');
            const modal = document.getElementById('destination-modal');
            
            if (closeModal && modal) {
                closeModal.addEventListener('click', () => hideModal(modal));
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        hideModal(modal);
                    }
                });
                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && modal.style.display === 'block') {
                        hideModal(modal);
                    }
                });
            }
            
            // Custom event for showing destination modal
            document.addEventListener('showDestinationModal', (e) => {
                showDestinationModal(e.detail.destinationId);
            });
        }

        /**
         * Clear all filters
         * Demonstrates form reset and DOM manipulation
         */
        function clearAllFilters() {
            // Reset filter values
            currentFilters = {
                search: '',
                category: 'all',
                region: 'all',
                costLevel: 'all'
            };
            currentSort = 'name';
            
            // Reset form elements
            document.getElementById('search-input').value = '';
            document.getElementById('category-filter').value = 'all';
            document.getElementById('region-filter').value = 'all';
            document.getElementById('cost-filter').value = 'all';
            document.getElementById('sort-select').value = 'name';
            
            // Reapply filters
            applyFiltersAndDisplay();
            
            // Save cleared state
            saveUserPreference('lastFilters', currentFilters);
        }

        /**
         * Show destination modal with details
         * Demonstrates async data handling and template literals
         */
        async function showDestinationModal(destinationId) {
            try {
                const destination = allDestinations.find(d => d.id == destinationId);
                
                if (!destination) {
                    throw new Error('Destination not found');
                }
                
                const modal = document.getElementById('destination-modal');
                const modalBody = document.getElementById('modal-body');
                const modalTitle = document.getElementById('modal-title');
                
                // Update modal content using template literals
                modalTitle.textContent = destination.name;
                modalBody.innerHTML = `
                    <div class="modal-destination-content">
                        <img src="${destination.image}" alt="${destination.name}" class="modal-image" loading="lazy">
                        <div class="modal-info">
                            <div class="destination-meta">
                                <span class="location">📍 ${destination.location}</span>
                                <span class="rating">⭐ ${destination.rating}/5</span>
                                <span class="cost">${destination.costLevel}</span>
                            </div>
                            <p class="description">${destination.description}</p>
                            <div class="destination-details">
                                <div class="detail-section">
                                    <h4>🎯 Activities</h4>
                                    <ul>
                                        ${destination.activities.map(activity => `<li>${activity}</li>`).join('')}
                                    </ul>
                                </div>
                                <div class="detail-section">
                                    <h4>📅 Best Time to Visit</h4>
                                    <p>${destination.bestTime}</p>
                                </div>
                                <div class="detail-section">
                                    <h4>⏰ Duration</h4>
                                    <p>${destination.duration}</p>
                                </div>
                                <div class="detail-section">
                                    <h4>✨ Highlights</h4>
                                    <ul>
                                        ${destination.highlights.map(highlight => `<li>${highlight}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                            <div class="modal-actions">
                                <button class="btn-primary" onclick="bookmarkDestination(${destination.id})">
                                    💾 Bookmark This Place
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                showModal(modal);
                
                // Save visited destination
                saveVisitedDestination(destination);
                
                // Track modal view
                saveUserPreference('lastViewedDestination', {
                    id: destinationId,
                    name: destination.name,
                    timestamp: new Date().toISOString()
                });
                
            } catch (error) {
                console.error('Error showing destination modal:', error);
                showNotification('Unable to load destination details.', 'error');
            }
        }

        /**
         * Bookmark destination function (global for button onclick)
         */
        window.bookmarkDestination = function(destinationId) {
            const destination = allDestinations.find(d => d.id == destinationId);
            if (destination) {
                // Save bookmark (you can implement this in storage.js)
                saveUserPreference('bookmarkedDestinations', 
                    [...(getUserPreference('bookmarkedDestinations', [])), destination]);
                
                showNotification(`${destination.name} bookmarked successfully!`, 'success', 3000);
            }
        };

        /**
         * Load user preferences
         * Demonstrates localStorage usage
         */
        function loadUserPreferences() {
            const lastFilters = getUserPreference('lastFilters');
            const lastSort = getUserPreference('lastSort', 'name');
            
            if (lastFilters) {
                currentFilters = { ...currentFilters, ...lastFilters };
                
                // Apply saved filters to form elements
                document.getElementById('search-input').value = currentFilters.search || '';
                document.getElementById('category-filter').value = currentFilters.category || 'all';
                document.getElementById('region-filter').value = currentFilters.region || 'all';
                document.getElementById('cost-filter').value = currentFilters.costLevel || 'all';
            }
            
            currentSort = lastSort;
            document.getElementById('sort-select').value = currentSort;
        }

        /**
         * Save filter preferences
         * Demonstrates localStorage usage
         */
        function saveFilterPreferences() {
            saveUserPreference('lastFilters', currentFilters);
            saveUserPreference('lastSort', currentSort);
            saveUserPreference('lastFilterUpdate', new Date().toISOString());
        }

        /**
         * Show error state
         */
        function showErrorState() {
            const container = document.getElementById('destinations-container');
            container.innerHTML = `
                <div class="no-results">
                    <div class="no-results-icon">⚠️</div>
                    <h3>Unable to Load Destinations</h3>
                    <p>There was an error loading the destinations. Please refresh the page and try again.</p>
                    <button onclick="window.location.reload()" class="btn-primary" style="margin-top: 1rem;">
                        🔄 Refresh Page
                    </button>
                </div>
            `;
        }
    </script>
</body>
</html>